<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>data_ingestion/weather/herbie_forecast &mdash; FarmVibes.AI  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../../../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../../../../_static/custom.css?v=85179c66" />

  
  <!--[if lt IE 9]>
    <script src="../../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="../../../../../" id="documentation_options" src="../../../../../_static/documentation_options.js?v=b3ba4146"></script>
        <script src="../../../../../_static/doctools.js?v=888ff710"></script>
        <script src="../../../../../_static/sphinx_highlight.js?v=4825356b"></script>
        <script src="https://unpkg.com/mermaid@9.4.0/dist/mermaid.min.js"></script>
        <script>mermaid.initialize({startOnLoad:true});</script>
    <script src="../../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../../index.html" class="icon icon-home">
            FarmVibes.AI
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guides &amp; Tutorials:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../QUICKSTART.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../AKS.html">Remote Cluster User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../CLIENT.html">FarmVibes.AI Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../WORKFLOWS.html">Workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../NOTEBOOK_LIST.html">Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../REST_API.html">REST API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../CACHE.html">Data Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../SECRETS.html">Secrets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../TROUBLESHOOTING.html">Troubleshooting</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Main Components:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../code/vibe_core_client/client.html">FarmVibes.AI Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../code/vibe_core_data/index_data_types.html">Data Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../WORKFLOW_LIST.html">Workflow List</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Supporting Components:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../code/vibe_core_client/admag_client.html">Azure Data Manager for Agriculture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../code/vibe_core_client/datamodel.html">Data Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../code/vibe_core_client/additional_modules/filedownloader.html">File Downloader</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../code/vibe_core_client/additional_modules/fileutils.html">File Utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../code/vibe_core_client/additional_modules/logconfig.html">Logconfig</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../code/vibe_core_client/additional_modules/monitor.html">Monitor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../code/vibe_core_client/additional_modules/uri.html">URI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../code/vibe_core_client/additional_modules/utils.html">Utils</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">FarmVibes.AI</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">data_ingestion/weather/herbie_forecast</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../../_sources/docfiles/markdown/workflow_yaml/data_ingestion/weather/herbie_forecast.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="data-ingestion-weather-herbie-forecast">
<h1>data_ingestion/weather/herbie_forecast<a class="headerlink" href="#data-ingestion-weather-herbie-forecast" title="Permalink to this heading"></a></h1>
<p>Downloads forecast observations for provided location &amp; time range using herbie python package. Herbie is a python package that downloads recent and archived numerical weather prediction (NWP) model outputs from different cloud archive sources. Its most popular capability is to download HRRR model data. NWP data in GRIB2 format can be read with xarray+cfgrib. Model data Herbie can retrieve includes the High Resolution Rapid Refresh (HRRR), Rapid Refresh (RAP), Global Forecast System (GFS), National Blend of Models (NBM), Rapid Refresh Forecast System - Prototype (RRFS), and ECMWF open data forecast products (ECMWF).</p>
<div class="mermaid">
                graph TD
    inp1&gt;user_input]
    out1&gt;weather_forecast]
    out2&gt;forecast_range]
    tsk1{{forecast_range}}
    tsk2{{forecast_download}}
    tsk1{{forecast_range}} -- download_period/user_input --&gt; tsk2{{forecast_download}}
    inp1&gt;user_input] -- user_input --&gt; tsk1{{forecast_range}}
    tsk2{{forecast_download}} -- weather_forecast --&gt; out1&gt;weather_forecast]
    tsk1{{forecast_range}} -- download_period --&gt; out2&gt;forecast_range]
        </div><section id="sources">
<h2>Sources<a class="headerlink" href="#sources" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p><strong>user_input</strong>: Time range and geometry of interest.</p></li>
</ul>
</section>
<section id="sinks">
<h2>Sinks<a class="headerlink" href="#sinks" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p><strong>weather_forecast</strong>: Downloaded Forecast observations, cleaned, interpolated and mapped to each hour.</p></li>
<li><p><strong>forecast_range</strong>: Time range of forecast observations.</p></li>
</ul>
</section>
<section id="parameters">
<h2>Parameters<a class="headerlink" href="#parameters" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p><strong>forecast_lead_times</strong>: Help to define forecast lead time in hours. Accept the input in range format. Example - (1, 25, 1) For more information refer below url. https://blaylockbk.github.io/Herbie/_build/html/reference_guide/_autosummary/herbie.archive.Herbie.html</p></li>
<li><p><strong>search_text</strong>: It’s a regular expression used to search on GRIB2 Index files and allow you to download just the layer of the file required instead of complete file. For more information on search_text refer to below url. https://blaylockbk.github.io/Herbie/_build/html/user_guide/searchString.html</p></li>
<li><p><strong>weather_type</strong>: It’s a user preferred text to represent weather parameter type (temperature, humidity, wind_speed etc). This is used as column name for the output returned by operator.</p></li>
<li><p><strong>model</strong>: Model name as defined in the models template folder. CASE INSENSITIVE Below are examples of model types ‘hrrr’ HRRR contiguous United States model ‘hrrrak’ HRRR Alaska model (alias ‘alaska’) ‘rap’ RAP model ‘gfs’ Global Forecast System (atmosphere) ‘gfs_wave’ Global Forecast System (wave) ‘rrfs’ Rapid Refresh Forecast System prototype</p></li>
<li><p><strong>overwrite</strong>: If true, look for GRIB2 file even if local copy exists. If false, use the local copy</p></li>
<li><p><strong>product</strong>: Output variable product file type (sfc (surface fields), prs (pressure fields), nat (native fields), subh (subhourly fields)). Not specifying this will use the first product in model template file.</p></li>
</ul>
</section>
<section id="tasks">
<h2>Tasks<a class="headerlink" href="#tasks" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p><strong>forecast_range</strong>: Splits input time range according to frequency and number of hours in lead time.</p></li>
<li><p><strong>forecast_download</strong>: Downloads forecast observations with Herbie.</p></li>
</ul>
</section>
<section id="workflow-yaml">
<h2>Workflow Yaml<a class="headerlink" href="#workflow-yaml" title="Permalink to this heading"></a></h2>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">forecast_weather</span>
<span class="nt">sources</span><span class="p">:</span>
<span class="w">  </span><span class="nt">user_input</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">forecast_range.user_input</span>
<span class="nt">sinks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">weather_forecast</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">forecast_download.weather_forecast</span>
<span class="w">  </span><span class="nt">forecast_range</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">forecast_range.download_period</span>
<span class="nt">parameters</span><span class="p">:</span>
<span class="w">  </span><span class="nt">forecast_lead_times</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">  </span><span class="nt">search_text</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">  </span><span class="nt">weather_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">  </span><span class="nt">model</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">  </span><span class="nt">overwrite</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">  </span><span class="nt">product</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">tasks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">forecast_range</span><span class="p">:</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">forecast_range_split</span>
<span class="w">    </span><span class="nt">op_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">download_herbie</span>
<span class="w">    </span><span class="nt">parameters</span><span class="p">:</span>
<span class="w">      </span><span class="nt">forecast_lead_times</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;@from(forecast_lead_times)&#39;</span>
<span class="w">      </span><span class="nt">weather_type</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;@from(weather_type)&#39;</span>
<span class="w">  </span><span class="nt">forecast_download</span><span class="p">:</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">forecast_weather</span>
<span class="w">    </span><span class="nt">op_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">download_herbie</span>
<span class="w">    </span><span class="nt">parameters</span><span class="p">:</span>
<span class="w">      </span><span class="nt">model</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;@from(model)&#39;</span>
<span class="w">      </span><span class="nt">overwrite</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;@from(overwrite)&#39;</span>
<span class="w">      </span><span class="nt">product</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;@from(product)&#39;</span>
<span class="w">      </span><span class="nt">forecast_lead_times</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;@from(forecast_lead_times)&#39;</span>
<span class="w">      </span><span class="nt">search_text</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;@from(search_text)&#39;</span>
<span class="w">      </span><span class="nt">weather_type</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;@from(weather_type)&#39;</span>
<span class="nt">edges</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">origin</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">forecast_range.download_period</span>
<span class="w">  </span><span class="nt">destination</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">forecast_download.user_input</span>
<span class="nt">description</span><span class="p">:</span>
<span class="w">  </span><span class="nt">short_description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Downloads forecast observations for provided location &amp; time</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">range using herbie python package.</span>
<span class="w">  </span><span class="nt">long_description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Herbie is a python package that downloads recent and archived</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">numerical weather prediction (NWP) model outputs from different cloud archive</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">sources. Its most popular capability is to download HRRR model data. NWP data</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">in GRIB2 format can be read with xarray+cfgrib. Model data Herbie can retrieve</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">includes the High Resolution Rapid Refresh (HRRR), Rapid Refresh (RAP), Global</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">Forecast System (GFS), National Blend of Models (NBM), Rapid Refresh Forecast</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">System - Prototype (RRFS), and ECMWF open data forecast products (ECMWF).</span>
<span class="w">  </span><span class="nt">sources</span><span class="p">:</span>
<span class="w">    </span><span class="nt">user_input</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Time range and geometry of interest.</span>
<span class="w">  </span><span class="nt">sinks</span><span class="p">:</span>
<span class="w">    </span><span class="nt">weather_forecast</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Downloaded Forecast observations, cleaned, interpolated and</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">mapped to each hour.</span>
<span class="w">    </span><span class="nt">forecast_range</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Time range of forecast observations.</span>
<span class="w">  </span><span class="nt">parameters</span><span class="p">:</span>
<span class="w">    </span><span class="nt">model</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Model name as defined in the models template folder. CASE INSENSITIVE Below</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">are examples of model types &#39;hrrr&#39; HRRR contiguous United States model &#39;hrrrak&#39;</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">HRRR Alaska model (alias &#39;alaska&#39;) &#39;rap&#39; RAP model &#39;gfs&#39; Global Forecast System</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">(atmosphere) &#39;gfs_wave&#39; Global Forecast System (wave) &#39;rrfs&#39; Rapid Refresh Forecast</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">System prototype</span>
<span class="w">    </span><span class="nt">overwrite</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">If true, look for GRIB2 file even if local copy exists. If false, use</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">the local copy</span>
<span class="w">    </span><span class="nt">product</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Output variable product file type (sfc (surface fields), prs (pressure</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">fields), nat (native fields), subh (subhourly fields)). Not specifying this</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">will use the first product in model template file.</span>
<span class="w">    </span><span class="nt">forecast_lead_times</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Help to define forecast lead time in hours. Accept the input</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">in range format. Example - (1, 25, 1) For more information refer below url.</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">https://blaylockbk.github.io/Herbie/_build/html/reference_guide/_autosummary/herbie.archive.Herbie.html</span>
<span class="w">    </span><span class="nt">search_text</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">It&#39;s a regular expression used to search on GRIB2 Index files and</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">allow you to download just the layer of the file required instead of complete</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">file. For more information on search_text refer to below url. https://blaylockbk.github.io/Herbie/_build/html/user_guide/searchString.html</span>
<span class="w">    </span><span class="nt">weather_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">It&#39;s a user preferred text to represent weather parameter type (temperature,</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">humidity, wind_speed etc). This is used as column name for the output returned</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">by operator.</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Microsoft.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>